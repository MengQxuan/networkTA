# 实验4：互联网组网与路由器配置

---

> **学号：2212452\
姓名：孟启轩\
专业：计算机科学与技术**


## 一、实验内容说明

##### 1. 实体环境下互联网组网与路由器配置

在实体环境下完成互联网组网与路由器配置，要求如下：
- （1）在机房实验室环境下，通过将局域网划分为不同子网，用多IP主机作为路由器，组建互联网。
- （2）在命令行方式下，按照静态路由方式，配置路由器和主机，测试互联网的连通性。

##### 2. 仿真环境下的互联网组网与路由器配置

在仿真环境下完成互联网组网与路由器配置，要求如下：
- （1）学习路由器的配置方法和配置命令。
- （2）参考实体实验，组建由多个路由器组成的互联网。物理网络可以由集线器、交换机构成。
- （3）按照静态路由方式配置路由器和主机，测试互联网的连通性。
- （4）利用动态路由方式配置路由器和主机，测试互联网的连通性。
- （5）在仿真环境的“模拟”方式中观察数据包在互联网中的传递过程，并进行分析。



## 二、前期准备

### 1、实体环境下互联网组网与路由器配置


在机房中的实体环境下使用4台电脑来完成本次实验，其中的两台电脑是配置双网卡使得其可以充当成一个路由器。

##### (1)拓扑图

![](拓扑图.png)

##### (2)IP地址分配

> 由于实验室环境中大家的主机较多，并且最初按照拓扑图中的`IP`地址进行分配但是实验失败了，所以设计新的的地址。

| PC机或端口号 | IPv4地址 | 子网掩码 | 网关 |
| :----: | :----: | :----: | :----: |
| 主机A | 10.11.0.1 | 255.255.255.0 | 10.11.0.2 |
| 主机B | 10.13.0.2 | 255.255.255.0 | 10.13.0.1 |
| 路由器R1 左端 | 10.11.0.2 | 255.255.255.0 |  |
| 路由器R1 右端 | 10.12.0.2 | 255.255.255.0 |  |
| 路由器R2 左端 | 10.12.0.1 | 255.255.255.0 |  |
| 路由器R2 右端 | 10.13.0.1 | 255.255.255.0 |  |

### 2、仿真环境下的互联网组网与路由器配置
##### (1)仿真拓扑图

![](ip.png)

##### (2)ip地址分配

| PC机或端口号 | IPv4地址 | 子网掩码 | 网关 |
| :----: | :----: | :----: | :----: |
| PC0 | 10.2.0.1 | 255.255.0.0 | 10.2.0.2 |
| PC1 | 10.2.0.3 | 255.255.0.0 | 10.2.0.2 |
| PC2 | 10.3.0.3 | 255.255.0.0 | 10.3.0.1 |
| PC3 | 10.3.0.2 | 255.255.0.0 | 10.3.0.1 |
| Router0 Gig0/0 | 10.2.0.2 | 255.255.0.0 |  |
| Router0 Gig0/1 | 10.1.0.2 | 255.255.0.0 |  |
| Router1 Gig0/0 | 10.3.0.1 | 255.255.0.0 |  |
| Router1 Gig0/1 | 10.1.0.1 | 255.255.0.0 |  |


## 三、实验过程

### 1、实体环境下互联网组网与路由器配置

##### (1)配置两台主机

本次的四台主机都是`Windows 10`操作系统，在电脑桌面上打开`网络和共享中心`后选择`本地连接`，然后将前期准备中提到的`IP地址`设置到这两台主机中，并为其设置相应的网关，配置完成后如以下图所示(我这里只列出主机A的配置)：

![](主机A.png)

##### (2)配置两台路由器

为剩下的两台主机中配置相应的`IP地址`，两台作为路由器的电脑需要配置单网卡多IP，在配置路由界面的`高级`选项中为其进行配置前期准备中设置好的`IP地址`，配置完成后如以下图所示(我这里只列出路由器1的配置)：

![](路由器1.1.png)

![](路由器1.2.png)



##### (3)配置路由器转发表

在配置完路由器的`IP地址`后，需要设置其下一跳，设置完成后可以看到路由转发表如下两图所示：
```bash
route ADD 10.13.0.0 MASK 255.255.255.0 10.12.0.1
route PRINT
```
![](路由器1.3.png)

##### (4)服务与防火墙


最后还需要开启路由器的转发服务和关闭所有的四台主机的防火墙服务:

![](防火墙.png)

##### (5)实验结果

```bash
ping 10.13.0.2
```

![](结果1.png)

发现无法`ping`通，经过助教学长的提示，我们从主机A到路由器1，路由器1到路由器2，路由器2到主机B进行两两之间的`ping`，发现是能`ping`通的（如上图主机A`ping`路由器1），但是主机A到主机B却不可以，当时不清楚哪里出了问题，实验回来后思考可能是路由器的默认网关设置错误。


### 2、仿真环境下的互联网组网与路由器配置

在仿真环境下分为静态路由和动态路由两部分：


> 静态路由


##### (1)配置PC机IP地址


按照前期准备的介绍配置四个PC机的IP和默认网关，配置的具体方法如下(我这里只列出PC0的配置):
![](PC0.png)

##### (2)配置路由器IP地址和路由表


- 打开路由器的CLI界面，使用下面指令分别配置两个路由器的接口Gig0/0、Gig0/1
- 使用指令`ip route 目标网络 掩码 下一条IP地址`，在路由器的CLI中添加表项
```bash
Router>enable
Router#config terminal
Enter configuration commands,one per line.End with CNTL/Z.
Router(config)#
Router(config)#interface gig0/0
Router (config-if)#ip address 10.2.0.2 255.255.0.0
Router(config-if)#exit
Router(config)#ip route10.3.0.0 255.255.0.0 10.1.0.1
Router (config)#
&LINEPROTO-5-UPDOWN:Line protocol on Interface
GigabitEthernet0/1,changed state to up
```
![](router0.png)
![](router1.png)

使用指令`show ip route`查看表项：

![](router2.png)

##### (3)实验结果

在其中一个pc终端的命令行中使用`ping`命令，并使用`tracert`命令追踪数据流，如下图所示:

![](结果2.png)

> 动态路由

##### (1)配置说明

使用与静态路由完全相同的拓扑图和IP配置，所以其配置直接参照静态路由的配置方法配置即可，在这里就不再进行赘述。

##### (2)配置RIP

先在两台路由器下进入`RIP`配置模式，需要选择支持子网划分的RIP版本`version 2`，并为其配置直接相连的网络，最后在两台路由器下的配置界面如下图所示（我这里只列出路由器1的配置）：

![](rip.png)

##### (3)实验结果

在其中一个pc终端的命令行中使用`ping`和`tracert`命令追踪数据流，如下图所示:

![](结果3.png)


> 数据报传输模拟

在仿真环境下的模拟中模拟数据报的传输，观察数据包在互联网中的传递过程：

![](模拟.png)
![](过程.png)



## 四、实验中遇到的问题
- 路由器配置问题：在配置路由器时，由于实验室环境中大家的主机较多，并且最初按照拓扑图中的`IP`地址进行分配但是实验失败了，所以设计新的的地址。
- 仿真实验中：可以看到第一次`ping`出现了`Request time out`
通过仿真环境下的模拟寻找原因，发现第一次ping，它发送了ARP请求，通过ARP协议来获取对方`IP`地址对应的`MAC`地址。所以第一次出现了`Request time out`。

## 五、总结与心得

通过本次实验，我深入学习了互联网组网与路由器配置的基本知识。在实体环境中，我使用四台计算机进行网络配置，成功地将两台计算机设置为路由器，并调整了IP地址和路由表，以实现网络间的互联。此外，在仿真环境下，我学习了静态路由和动态路由的配置，并通过ping和tracert命令验证了网络的连通性，这一过程加深了我对网络数据传输过程的理解。在实验中，我特别关注了数据包在网络中的传递机制，通过ARP请求的学习，明白了如何通过地址解析来确保通信的顺利进行。这些经验让我对网络技术有了更加直观的认识。
